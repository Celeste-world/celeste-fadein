<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Celeste – Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="icon" href="/images/favicon.svg" type="image/svg+xml">

  <style>
    :root{
      --bg:#050811;
      --panel:rgba(17,22,35,.72);
      --text:#e8ebef;
      --accent:#9bbcff;
      --radius:18px;
      --shadow:0 24px 70px rgba(0,0,0,.55);
      --vh:100vh;
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      height:var(--vh);
      background:
        radial-gradient(1200px 800px at 35% 20%, rgba(80,120,255,.2), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      overflow:hidden;
    }

    .console{
      width:100%;
      max-width:820px;
      background:var(--panel);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:28px 28px 22px;
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    .log{
      flex:1;
      overflow-y:auto;
      white-space:pre-wrap;
      line-height:1.6;
      font-size:16px;
    }

    .log p{
      margin:0 0 12px;
    }

    .input-wrap{
      display:flex;
      gap:12px;
      border-top:1px solid rgba(255,255,255,.08);
      padding-top:14px;
    }

    input{
      flex:1;
      background:transparent;
      border:none;
      outline:none;
      color:var(--text);
      font-size:16px;
      font-family:inherit;
    }

    input::placeholder{
      color:rgba(232,235,239,.45);
    }

    .footer{
      display:flex;
      justify-content:space-between;
      font-size:12px;
      opacity:.6;
      margin-top:4px;
    }

    a{
      color:var(--accent);
      text-decoration:none;
    }
  </style>
</head>

<body>
  <div class="console">
    <div id="log" class="log">
      <p>こんにちは</p>
    </div>

    <div class="input-wrap">
      <input
        id="input"
        type="text"
        placeholder="Write freely."
        autocomplete="off"
      />
    </div>

    <div class="footer">
      <a href="/about.html">Back to About</a>
      <span>CELESTE v4.4A</span>
    </div>
  </div>

<script>
/* =========================================================
   Celeste Console – dev / prod unified
   No pressure logic, no silence judgement on UI side
   ========================================================= */

const API = "https://celeste-api.celeste.world";

const logEl   = document.getElementById("log");
const inputEl = document.getElementById("input");

/* iOS viewport fix */
function setVH(){
  document.documentElement.style.setProperty(
    "--vh",
    `${window.innerHeight}px`
  );
}
setVH();
window.addEventListener("resize", setVH);
window.addEventListener("orientationchange", setVH);

/* append line to log */
function appendLine(text){
  const p = document.createElement("p");
  p.textContent = text;
  logEl.appendChild(p);
  logEl.scrollTop = logEl.scrollHeight;
}

/* send text to API */
async function send(text){
  try{
    const res = await fetch(API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: text })
    });

    const data = await res.json();

    // UI does NOT judge silence. API decides.
    if (typeof data.response === "string") {
      appendLine(data.response);
    }

  } catch (e){
    console.error(e);
  }
}

/* input handling */
inputEl.addEventListener("keydown", e => {
  if (e.key === "Enter") {
    const text = inputEl.value.trim();
    if (!text) return;

    appendLine(text);
    inputEl.value = "";
    send(text);
  }
});
</script>
</body>
</html>
