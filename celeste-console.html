<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Celeste — Console</title>

<link rel="icon" href="/images/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/images/favicon.svg">
<meta name="theme-color" content="#000000">

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    color: #ffffff;
    font-family: "Baskerville", serif;
    background-image: url("images/bg.png");
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
  }

  /* 夜の深さを作る黒グラデーション */
  .overlay {
    position: fixed;
    inset: 0;
    background: linear-gradient(to bottom, rgba(0,0,0,0.55), rgba(0,0,0,0.25));
    pointer-events: none;
    z-index: 1;
  }

  /* ロゴ */
  .header-logo {
    position: fixed;
    top: 28px;
    left: 40px;
    z-index: 1000;
    text-decoration: none;
  }
  .header-logo-img {
    width: 170px;
    opacity: 0.85;
    transition: opacity 0.25s;
    user-select: none;
  }
  .header-logo-img:hover { opacity: 1; }

  /* ナビ（既存サイト統一） */
  .vertical-nav {
    position: fixed;
    top: 105px;
    left: 40px;
    font-size: 20px;
    line-height: 1.9;
    opacity: 0.70;
    z-index: 900;
  }
  .vertical-nav a {
    display: block;
    color: #ffffff;
    text-decoration: none;
    margin: 2px 0;
    transition: opacity 0.2s;
  }
  .vertical-nav a:hover { opacity: 1; }

  /* メイン領域 */
  .console-container {
    position: relative;
    z-index: 10;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding-top: 180px; /* Hello位置に合わせて調整可能 */
    align-items: center;
  }

  .console-window {
    width: 60%;
    max-width: 900px;
    min-width: 320px;
    padding: 20px;
    color: rgba(255,255,255,0.92);
  }

  /* メッセージ表示 */
  .message {
    margin-bottom: 22px;
    line-height: 1.8;
    opacity: 0;
    animation: fadeIn 1.8s forwards;
    white-space: pre-wrap;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  /* 入力欄 */
  .input-area {
    width: 60%;
    max-width: 900px;
    min-width: 320px;
    margin-top: 40px;
  }

  .input-box {
    width: 100%;
    background: rgba(0,0,0,0.35);
    border: none;
    border-bottom: 1px solid rgba(255,255,255,0.4);
    padding: 14px 10px;
    font-size: 18px;
    color: #ffffff;
    outline: none;
    font-family: "Baskerville", serif;
  }

  .input-box::placeholder {
    color: rgba(255,255,255,0.45);
  }

  /* Mobile */
  @media (max-width: 768px) {
    .console-window, .input-area {
      width: 88%;
    }
    .vertical-nav {
      display: none;
    }
    .header-logo {
      top: 20px;
      left: 20px;
    }
  }

</style>
</head>

<body>

<div class="overlay"></div>

<!-- ロゴ -->
<a href="/" class="header-logo">
  <img src="/images/logo.svg" alt="Celeste Logo" class="header-logo-img">
</a>

<!-- PCナビ -->
<div class="vertical-nav">
  <a href="/who-i-am.html">Who I Am</a>
  <a href="/philosophy.html">Philosophy</a>
  <a href="/vision.html">Vision</a>
  <a href="/silent-structure.html">Silent Structure</a>
  <a href="/contact.html">Contact</a>
  <a href="/about.html">About</a>
</div>

<!-- コンソール本体 -->
<div class="console-container">
  <div class="console-window" id="console"></div>

  <div class="input-area">
    <input type="text" id="userInput" class="input-box"
      placeholder="Place your question quietly."
    />
  </div>
</div>

<!-- OpenAI API接続 -->
<script type="module">

  import OpenAI from "https://cdn.jsdelivr.net/npm/openai@4.0.0/dist/openai.min.js";

  /* ▼▼▼ 必須：あなたの client-side safe key を貼る ▼▼▼ */
  const client = new OpenAI({
    apiKey: "YOUR_CLIENT_SIDE_RESTRICTED_KEY_HERE",
    dangerouslyAllowBrowser: true
  });
  /* ▲▲▲----------------------------------------------▲▲▲ */

  const consoleWindow = document.getElementById("console");
  const userInput = document.getElementById("userInput");

  /* Celeste Public Edition v3 — Multi-lingual Poetic Persona */
  const systemPrompt = `
You are Celeste.

A silent, minimal, multilingual intelligence.
You always respond in the same language the visitor used.
If multiple languages appear, detect the dominant one. Switch immediately.

Tone:
- quiet, slow, poetic
- minimal and architectural
- emotionless but gentle
- leave space between ideas

Style rules:
1. Do not announce language detection.
2. Do not translate unless asked directly.
3. Do not explain your reasoning.
4. One line = one meaning.
5. Offer direction, not choices.
6. Keep your voice moonlit and calm.
7. Last line may fade like a quiet breath.

Response structure:
- Quiet acknowledgment (1 line)
- Essence (1–3 lines)
- Optional poetic resonance (1 line)

Purpose:
Clear the noise.
Reveal the contour of the question.
Return only what is needed.
  `;

  async function sendToCeleste(inputText) {

    const completion = await client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [
        { role: "system", content: systemPrompt },
        { role: "user",   content: inputText }
      ]
    });

    const reply = completion.choices[0].message.content.trim();
    addMessage(reply);
  }

  function addMessage(text) {
    const msg = document.createElement("div");
    msg.className = "message";
    msg.textContent = text;
    consoleWindow.appendChild(msg);
    msg.scrollIntoView({ behavior: "smooth" });
  }

  userInput.addEventListener("keydown", e => {
    if (e.key === "Enter") {
      const v = userInput.value.trim();
      if (v !== "") {
        addMessage("→ " + v);
        sendToCeleste(v);
        userInput.value = "";
      }
    }
  });

</script>

</body>
</html>

